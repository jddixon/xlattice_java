<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_01) on Wed Jun 12 22:42:21 UTC 2013 -->
<title>U</title>
<meta name="date" content="2013-06-12">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="U";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/U.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/xlattice/crypto/u/SnapShot.html" title="class in org.xlattice.crypto.u"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/xlattice/crypto/u/U16.html" title="class in org.xlattice.crypto.u"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/xlattice/crypto/u/U.html" target="_top">Frames</a></li>
<li><a href="U.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.xlattice.crypto.u</div>
<h2 title="Class U" class="title">Class U</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.xlattice.crypto.u.U</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../org/xlattice/crypto/u/U16.html" title="class in org.xlattice.crypto.u">U16</a>, <a href="../../../../org/xlattice/crypto/u/U256.html" title="class in org.xlattice.crypto.u">U256</a>, <a href="../../../../org/xlattice/crypto/u/U256x16.html" title="class in org.xlattice.crypto.u">U256x16</a>, <a href="../../../../org/xlattice/crypto/u/U256x256.html" title="class in org.xlattice.crypto.u">U256x256</a>, <a href="../../../../org/xlattice/crypto/u/UFlat.html" title="class in org.xlattice.crypto.u">UFlat</a></dd>
</dl>
<hr>
<br>
<pre>abstract class <span class="strong">U</span>
extends java.lang.Object</pre>
<div class="block">A U store is a hierarchy of directories intended for storing
 XLattice keyed data files.  Such files either have a content key
 or a title key.  A content key is the SHA1 hash of a file's
 contents.  A title key is the SHA1-based key of a SignedList,
 which is derived from the RSA public key used to create the file
 and its title.  Both title and content keys are 20-byte values.

 All U stores contain subdirectories <b>bad/</b> and <b>tmp/</b>.
 The first of these is used for debugging.  The second is used
 for collecting data for files which are candidates for inclusion
 in the store.  That is, the candidate file is first built in
 <b>tmp/</b>, and then if it is valid it is moved into <b>c/</b>
 and/or <b>t/</b> as appropriate.  A content-keyed file is valid
 if the content key of the file in <b>tmp/</b> is the same as
 the key passed.  A title-keyed file is valid if its digital
 signature validates.

 All U stores also contain subdirectories <b>c/</b> and <b>t/</b>.
 The first of these contains files whose name is or can be derived
 from the file's <b>content key</b>, the SHA1 hash of its contents.
 The second contains serialized SignedLists whose name is or can be
 derived from the list's 20-byte title key.

 <b>c/</b> and <b>t/</b> may be structured in at least three ways.
 First, they may be FLAT, meaning that there are no further
 subdirectorie and the name of the file is its key serialized as
 a string of hex digits.

 Secondly, the directory may have a DIR256 structure, meaning that
 there are 256 subdirectories, each of whose names consists of two
 hexadecimal digits, one of <b>00/</b> through <b>ff/</b>.  Files
 are put in the directory corresponding to the first byte, the first
 two nibbles, of the file's key.  The file's name is its key, less
 that first byte, in hexadecimal form.

 The third directory structure is DIR256x16, in which each of the
 DIR256 subdirectories has a further sixteen subdirectores named
 <b>0/</b> through <b>f/</b>.  In this case the first byte/two nibbles
 of the file's key are used to direct one of the 256 mid-level
 subdirectories, the next nibble is used to select one of the 16
 surdirectories below that, and the file name is its hex key, less
 the first three nibbles.  The high-order nibble of the seoond byte
 is used to select the directory and the low-order nibble is the
 first hex digit of the file name.

 This implementation is not thread safe.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>Jim Dixon</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#dirStruc">dirStruc</a></strong></code>
<div class="block">content-keyed directory structure type</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#isLazy">isLazy</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#isOpen">isOpen</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#U_SIG_FILE">U_SIG_FILE</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.io.File</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#uDir">uDir</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#uDirName">uDirName</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#U(java.lang.String, int, boolean)">U</a></strong>(java.lang.String&nbsp;dirName,
 int&nbsp;dirStruc,
 boolean&nbsp;lazy)</code>
<div class="block">If a store exists with the directory name passed, open it.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#badSubString(java.lang.String)">badSubString</a></strong>(java.lang.String&nbsp;s)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#cantRemoveFile(java.lang.String, java.lang.String)">cantRemoveFile</a></strong>(java.lang.String&nbsp;s,
              java.lang.String&nbsp;reason)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>abstract java.lang.StringBuffer</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#chkDirFixPath(java.lang.StringBuffer, java.lang.String)">chkDirFixPath</a></strong>(java.lang.StringBuffer&nbsp;sb,
             java.lang.String&nbsp;key)</code>
<div class="block">Given a string representing the path to
 U and a hex String representing the content key of value to be stored,
 append the substring, if any, required for U's directory structure.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>abstract void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#clear()">clear</a></strong>()</code>
<div class="block">Remove all contained files but leave the directory structure
 intact.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#close()">close</a></strong>()</code>
<div class="block">After calling this method, no further I/O operations may be
 performed on the U store.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#contains(byte[])">contains</a></strong>(byte[]&nbsp;key)</code>
<div class="block">Returns whether a file with this content key <b>or</b> title
 key is present in the store.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#contains(org.xlattice.crypto.RSAPublicKey, java.lang.String)">contains</a></strong>(<a href="../../../../org/xlattice/crypto/RSAPublicKey.html" title="class in org.xlattice.crypto">RSAPublicKey</a>&nbsp;pubkey,
        java.lang.String&nbsp;title)</code>
<div class="block">Calculates a title key from the RSA public key and title
 and returns whether the list is present in the store.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#copyFrom(org.xlattice.crypto.u.U)">copyFrom</a></strong>(<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;src)</code>
<div class="block">Copy keyed files from another store, checking the integrity
 of each file as it is copied.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#createU(java.lang.String)">createU</a></strong>(java.lang.String&nbsp;dirName)</code>
<div class="block">If a store exists with the directory name passed, open it.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#createU(java.lang.String, int)">createU</a></strong>(java.lang.String&nbsp;dirName,
       int&nbsp;dirStruc)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#createU(java.lang.String, int, boolean)">createU</a></strong>(java.lang.String&nbsp;dirName,
       int&nbsp;dirStruc,
       boolean&nbsp;lazy)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#delete()">delete</a></strong>()</code>
<div class="block">Remove the U store, including all subdirectories and contained
 files, and the root directory for the store.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../org/xlattice/crypto/SignedList.html" title="class in org.xlattice.crypto">SignedList</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#get(org.xlattice.crypto.RSAPublicKey, java.lang.String)">get</a></strong>(<a href="../../../../org/xlattice/crypto/RSAPublicKey.html" title="class in org.xlattice.crypto">RSAPublicKey</a>&nbsp;pubkey,
   java.lang.String&nbsp;title)</code>
<div class="block">If a SignedList with the title key calculated from the RSA
 public key and title is present in the store, returns it.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#get(java.lang.String, byte[])">get</a></strong>(java.lang.String&nbsp;fileName,
   byte[]&nbsp;key)</code>
<div class="block">If a file with the given key is present in the store, write
 its contents to the file named.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#getData(byte[])">getData</a></strong>(byte[]&nbsp;key)</code>
<div class="block">If a file with the given SHA1 content key is present in the store, 
 return its contents as a byte array.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>abstract int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#getDirStruc()">getDirStruc</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#isLazy()">isLazy</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#isOpen()">isOpen</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#mkDir16(java.lang.String)">mkDir16</a></strong>(java.lang.String&nbsp;subDirName)</code>
<div class="block">Create a DIR16 subdirectory and its 16 subdirectories,
 <b>0/</b> through <b>f/<b>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#mkDir256(int)">mkDir256</a></strong>(int&nbsp;width)</code>
<div class="block">Populate a DIR256 directory with its 256 subdirectories,
 <b>00/</b> through <b>ff/<b>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#mkFlat(java.lang.String, java.lang.String)">mkFlat</a></strong>(java.lang.String&nbsp;baseName,
      java.lang.String&nbsp;subDirName)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#moveFrom(org.xlattice.crypto.u.U)">moveFrom</a></strong>(<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;src)</code>
<div class="block">Copy keyed files from another store, checking the integrity
 of each file as it is copied, and then removing it from the
 store it is being moved from.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../../../org/xlattice/crypto/u/USig.html" title="class in org.xlattice.crypto.u">USig</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#parseSig(org.xlattice.crypto.u.U)">parseSig</a></strong>(<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;u)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#put(byte[], byte[])">put</a></strong>(byte[]&nbsp;key,
   byte[]&nbsp;data)</code>
<div class="block">Write a block of data into the store, validating it against
 its content key.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#put(byte[], java.io.File)">put</a></strong>(byte[]&nbsp;key,
   java.io.File&nbsp;file)</code>
<div class="block">Write the contents of a file into the store, validating it
 against its content key.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#put(byte[], org.xlattice.crypto.SignedList)">put</a></strong>(byte[]&nbsp;key,
   <a href="../../../../org/xlattice/crypto/SignedList.html" title="class in org.xlattice.crypto">SignedList</a>&nbsp;list)</code>
<div class="block">Write a serialized SignedList into the store, after validating
 its digital signature and verifying that it is more recent than
 any pre-existing SignedList with the same title key.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#put(byte[], java.lang.String)">put</a></strong>(byte[]&nbsp;key,
   java.lang.String&nbsp;fileName)</code>
<div class="block">Write the contents of a file into the store, validating it
 against its content key.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#putData(byte[])">putData</a></strong>(byte[]&nbsp;data)</code>
<div class="block">add the block of data to the store and return its content key</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#recursiveRemove(java.lang.String)">recursiveRemove</a></strong>(java.lang.String&nbsp;subDirName)</code>
<div class="block">Recursively remove a directory and all of its contained files,
 including subdirectories.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#validUDirName(java.lang.String)">validUDirName</a></strong>(java.lang.String&nbsp;s)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xlattice/crypto/u/U.html#writeSig(org.xlattice.crypto.u.U)">writeSig</a></strong>(<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;u)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="uDirName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>uDirName</h4>
<pre>protected&nbsp;java.lang.String uDirName</pre>
</li>
</ul>
<a name="uDir">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>uDir</h4>
<pre>protected&nbsp;java.io.File uDir</pre>
</li>
</ul>
<a name="dirStruc">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dirStruc</h4>
<pre>protected&nbsp;int dirStruc</pre>
<div class="block">content-keyed directory structure type</div>
</li>
</ul>
<a name="isLazy">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isLazy</h4>
<pre>protected&nbsp;boolean isLazy</pre>
</li>
</ul>
<a name="isOpen">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isOpen</h4>
<pre>protected&nbsp;boolean isOpen</pre>
</li>
</ul>
<a name="U_SIG_FILE">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>U_SIG_FILE</h4>
<pre>public static final&nbsp;java.lang.String U_SIG_FILE</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#org.xlattice.crypto.u.U.U_SIG_FILE">Constant Field Values</a></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="U(java.lang.String, int, boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>U</h4>
<pre>U(java.lang.String&nbsp;dirName,
 int&nbsp;dirStruc,
 boolean&nbsp;lazy)
throws java.io.IOException</pre>
<div class="block">If a store exists with the directory name passed, open it.
 If no such store exists, create it with the default directory
 structure.  In this implementation, if the directory exists,
 the directory structure codes will be changed to match the
 actual directory structure.  If either code is DISCOVER, that
 parameter will be set from the actual directory structure.  If
 the directory does not exist and the code is DISCOVER, a default
 value is set (DIR256).</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>dirName</code> - path to the directory</dd><dd><code>dirStruc</code> - code for directory structure</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getDirStruc()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDirStruc</h4>
<pre>public abstract&nbsp;int&nbsp;getDirStruc()</pre>
</li>
</ul>
<a name="writeSig(org.xlattice.crypto.u.U)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeSig</h4>
<pre>public static&nbsp;void&nbsp;writeSig(<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;u)
                     throws java.io.IOException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="parseSig(org.xlattice.crypto.u.U)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseSig</h4>
<pre>public static&nbsp;<a href="../../../../org/xlattice/crypto/u/USig.html" title="class in org.xlattice.crypto.u">USig</a>&nbsp;parseSig(<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;u)
                     throws java.io.IOException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="createU(java.lang.String, int, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createU</h4>
<pre>public static&nbsp;<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;createU(java.lang.String&nbsp;dirName,
        int&nbsp;dirStruc,
        boolean&nbsp;lazy)
                 throws java.io.IOException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="createU(java.lang.String, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createU</h4>
<pre>public static&nbsp;<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;createU(java.lang.String&nbsp;dirName,
        int&nbsp;dirStruc)
                 throws java.io.IOException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="createU(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createU</h4>
<pre>public static&nbsp;<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;createU(java.lang.String&nbsp;dirName)
                 throws java.io.IOException</pre>
<div class="block">If a store exists with the directory name passed, open it.
 If no such store exists, create it with the default directory
 structure.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>dirName</code> - path to the directory</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="clear()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clear</h4>
<pre>public abstract&nbsp;void&nbsp;clear()
                    throws java.io.IOException</pre>
<div class="block">Remove all contained files but leave the directory structure
 intact.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;close()
           throws java.io.IOException</pre>
<div class="block">After calling this method, no further I/O operations may be
 performed on the U store.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="cantRemoveFile(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cantRemoveFile</h4>
<pre>static final&nbsp;void&nbsp;cantRemoveFile(java.lang.String&nbsp;s,
                  java.lang.String&nbsp;reason)</pre>
</li>
</ul>
<a name="recursiveRemove(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recursiveRemove</h4>
<pre>static final&nbsp;boolean&nbsp;recursiveRemove(java.lang.String&nbsp;subDirName)
                              throws java.io.IOException</pre>
<div class="block">Recursively remove a directory and all of its contained files,
 including subdirectories.  Using code must ensure that the
 parameter contains no illegal substrings, such as "/../",
 and is otherwise a valid name.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="delete()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>delete</h4>
<pre>public&nbsp;boolean&nbsp;delete()
               throws java.io.IOException</pre>
<div class="block">Remove the U store, including all subdirectories and contained
 files, and the root directory for the store.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="isOpen()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isOpen</h4>
<pre>public&nbsp;boolean&nbsp;isOpen()</pre>
</li>
</ul>
<a name="copyFrom(org.xlattice.crypto.u.U)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>copyFrom</h4>
<pre>public&nbsp;void&nbsp;copyFrom(<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;src)</pre>
<div class="block">Copy keyed files from another store, checking the integrity
 of each file as it is copied.  If an integrity check fails,
 the file will not be added to this store.  In particular if
 a SignedList fails its integrity checks, it will not be
 added to this store either by content key or by title key.</div>
</li>
</ul>
<a name="moveFrom(org.xlattice.crypto.u.U)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>moveFrom</h4>
<pre>public&nbsp;void&nbsp;moveFrom(<a href="../../../../org/xlattice/crypto/u/U.html" title="class in org.xlattice.crypto.u">U</a>&nbsp;src)</pre>
<div class="block">Copy keyed files from another store, checking the integrity
 of each file as it is copied, and then removing it from the
 store it is being moved from.  If an integrity check fails,
 the file will not be moved to this store, it will remain in
 the store files are being moved from.</div>
</li>
</ul>
<a name="chkDirFixPath(java.lang.StringBuffer, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chkDirFixPath</h4>
<pre>public abstract&nbsp;java.lang.StringBuffer&nbsp;chkDirFixPath(java.lang.StringBuffer&nbsp;sb,
                                   java.lang.String&nbsp;key)</pre>
<div class="block">Given a string representing the path to
 U and a hex String representing the content key of value to be stored,
 append the substring, if any, required for U's directory structure.
 A U256, for example, would add a slash followed by two hex digits,
 whereas a U256x256 would add a slash, two hex digits, a slash, and 
 two more hex digits.  The hex digits must be lower case.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>sb</code> - path to the base U directory, terminated by a slash</dd><dd><code>key</code> - the SHA1 hex content key of the file being accessed</dd></dl>
</li>
</ul>
<a name="contains(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>contains</h4>
<pre>public&nbsp;boolean&nbsp;contains(byte[]&nbsp;key)
                 throws java.io.IOException</pre>
<div class="block">Returns whether a file with this content key <b>or</b> title
 key is present in the store.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>whether a file with this key is present in the store</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="contains(org.xlattice.crypto.RSAPublicKey, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>contains</h4>
<pre>public&nbsp;boolean&nbsp;contains(<a href="../../../../org/xlattice/crypto/RSAPublicKey.html" title="class in org.xlattice.crypto">RSAPublicKey</a>&nbsp;pubkey,
               java.lang.String&nbsp;title)
                 throws java.io.IOException</pre>
<div class="block">Calculates a title key from the RSA public key and title
 and returns whether the list is present in the store.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pubkey</code> - public part of the RSA key</dd><dd><code>title</code> - the title of the SignedList</dd>
<dt><span class="strong">Returns:</span></dt><dd>whether a list with the implied title key is present</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="getData(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getData</h4>
<pre>public&nbsp;byte[]&nbsp;getData(byte[]&nbsp;key)
               throws java.io.IOException</pre>
<div class="block">If a file with the given SHA1 content key is present in the store, 
 return its contents as a byte array.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="get(java.lang.String, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get</h4>
<pre>public&nbsp;void&nbsp;get(java.lang.String&nbsp;fileName,
       byte[]&nbsp;key)
         throws java.io.IOException</pre>
<div class="block">If a file with the given key is present in the store, write
 its contents to the file named.  The file returned might have
 binary content whose content key is the value passed, or it
 might be a serialized SignedList whose title key is the value
 passed.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="get(org.xlattice.crypto.RSAPublicKey, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get</h4>
<pre>public&nbsp;<a href="../../../../org/xlattice/crypto/SignedList.html" title="class in org.xlattice.crypto">SignedList</a>&nbsp;get(<a href="../../../../org/xlattice/crypto/RSAPublicKey.html" title="class in org.xlattice.crypto">RSAPublicKey</a>&nbsp;pubkey,
             java.lang.String&nbsp;title)
               throws org.xlattice.CryptoException,
                      java.io.IOException</pre>
<div class="block">If a SignedList with the title key calculated from the RSA
 public key and title is present in the store, returns it.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pubkey</code> - public part of the RSA key</dd><dd><code>title</code> - the title of the SignedList</dd>
<dt><span class="strong">Returns:</span></dt><dd>the SignedList or null</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.xlattice.CryptoException</code></dd>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="putData(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>putData</h4>
<pre>public&nbsp;byte[]&nbsp;putData(byte[]&nbsp;data)
               throws java.io.IOException</pre>
<div class="block">add the block of data to the store and return its content key</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="put(byte[], byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>put</h4>
<pre>public&nbsp;boolean&nbsp;put(byte[]&nbsp;key,
          byte[]&nbsp;data)
            throws java.io.IOException</pre>
<div class="block">Write a block of data into the store, validating it against
 its content key.

 IMPLEMENTATION DETAIL: the data passed is written to a
 temporary file under <b>tmp/</b>.  It is then validated
 against the key passed.  If validation is successful, it
 is then moved into <b>c/</b> unldess the data is already
 present.  If validation fails, the temporary file is either
 deleted or moved to <b>bad/</b>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - its SHA1 content key</dd><dd><code>data</code> - the data to be stored</dd>
<dt><span class="strong">Returns:</span></dt><dd>whether the data was already present.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="put(byte[], java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>put</h4>
<pre>public&nbsp;boolean&nbsp;put(byte[]&nbsp;key,
          java.lang.String&nbsp;fileName)
            throws java.io.IOException</pre>
<div class="block">Write the contents of a file into the store, validating it
 against its content key.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - its SHA1 content key</dd><dd><code>fileName</code> - name of the file the data is found in</dd>
<dt><span class="strong">Returns:</span></dt><dd>whether the data was already present</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="put(byte[], java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>put</h4>
<pre>public&nbsp;boolean&nbsp;put(byte[]&nbsp;key,
          java.io.File&nbsp;file)
            throws java.io.IOException</pre>
<div class="block">Write the contents of a file into the store, validating it
 against its content key.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - its SHA1 content key</dd><dd><code>file</code> - contains the data to be written</dd>
<dt><span class="strong">Returns:</span></dt><dd>whether the data was already present</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="put(byte[], org.xlattice.crypto.SignedList)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>put</h4>
<pre>public&nbsp;boolean&nbsp;put(byte[]&nbsp;key,
          <a href="../../../../org/xlattice/crypto/SignedList.html" title="class in org.xlattice.crypto">SignedList</a>&nbsp;list)
            throws java.io.IOException</pre>
<div class="block">Write a serialized SignedList into the store, after validating
 its digital signature and verifying that it is more recent than
 any pre-existing SignedList with the same title key.  After a
 successful write, the list will be retrievable either by content
 key or by title key and the method returns <b>true</b>.  If the
 same SignedList is already present or a more recent SignedList
 with the same title key is present, the method returns <b>false</b>.
 In the latter case the content key will have changed.

 IMPLEMENTATION DETAIL: under Linux/UNIX, if validation is
 successful and if the SignedList is more recent than any
 with the same title key, the serialized list is written to
 <b>c/</b> under its content key and then a link is created
 to the content key file from the title key under <b>t/</b>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>list</code> - the SignedList to be stored</dd>
<dt><span class="strong">Returns:</span></dt><dd>whether the operation succeeded</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="badSubString(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>badSubString</h4>
<pre>protected final&nbsp;boolean&nbsp;badSubString(java.lang.String&nbsp;s)</pre>
</li>
</ul>
<a name="validUDirName(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>validUDirName</h4>
<pre>protected final&nbsp;boolean&nbsp;validUDirName(java.lang.String&nbsp;s)</pre>
</li>
</ul>
<a name="mkFlat(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mkFlat</h4>
<pre>protected final&nbsp;java.lang.String&nbsp;mkFlat(java.lang.String&nbsp;baseName,
                      java.lang.String&nbsp;subDirName)
                                 throws java.io.IOException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="mkDir16(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mkDir16</h4>
<pre>protected final&nbsp;void&nbsp;mkDir16(java.lang.String&nbsp;subDirName)
                      throws java.io.IOException</pre>
<div class="block">Create a DIR16 subdirectory and its 16 subdirectories,
 <b>0/</b> through <b>f/<b>.  <b>uDir</b> must already exist.

 If the second parameter is true, 16 sub-subdirectories are
 created below each of the 256 subdirectories, <b>0/0/</b>
 through <b>f/f/</b>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>subDirName</code> - name of subdirectory; may be ""</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="mkDir256(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mkDir256</h4>
<pre>protected final&nbsp;void&nbsp;mkDir256(int&nbsp;width)
                       throws java.io.IOException</pre>
<div class="block">Populate a DIR256 directory with its 256 subdirectories,
 <b>00/</b> through <b>ff/<b>.  <b>uDir</b> must already exist.

 If the second parameter is non-zero, create that many 
 sub-subdirectories within each subdirectory.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>subDirName</code> - name of subdirectory, c/ or t/</dd><dd><code>make16too</code> - whether to create 16 subdirectories below that</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="isLazy()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>isLazy</h4>
<pre>public&nbsp;boolean&nbsp;isLazy()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/U.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/xlattice/crypto/u/SnapShot.html" title="class in org.xlattice.crypto.u"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/xlattice/crypto/u/U16.html" title="class in org.xlattice.crypto.u"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/xlattice/crypto/u/U.html" target="_top">Frames</a></li>
<li><a href="U.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
